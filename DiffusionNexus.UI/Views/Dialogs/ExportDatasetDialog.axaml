<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="using:DiffusionNexus.UI.Views.Dialogs"
        xmlns:vm="using:DiffusionNexus.UI.ViewModels"
        x:Class="DiffusionNexus.UI.Views.Dialogs.ExportDatasetDialog"
        x:DataType="vm:ExportDatasetDialogViewModel"
        Width="500"
        SizeToContent="Height"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        Background="#252526">
  
  <Grid Margin="24" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto">
    
    <!-- Title -->
    <TextBlock Grid.Row="0" 
               Text="{Binding DatasetName, StringFormat='Export: {0}'}"
               FontSize="18"
               FontWeight="SemiBold"
               Foreground="#D4A574"
               Margin="0,0,0,20"/>
    
    <!-- Export Type Selection -->
    <StackPanel Grid.Row="1" Margin="0,0,0,16">
      <TextBlock Text="Export Format"
                 FontWeight="SemiBold"
                 Margin="0,0,0,8"/>
      <StackPanel Orientation="Horizontal" Spacing="16">
        <RadioButton Content="Single Files (Images/Videos + .txt)"
                     IsChecked="{Binding IsSingleFilesExport}"
                     GroupName="ExportType"/>
        <RadioButton Content="ZIP Archive"
                     IsChecked="{Binding IsZipExport}"
                     GroupName="ExportType"/>
      </StackPanel>
    </StackPanel>
    
    <!-- Export Options -->
    <StackPanel Grid.Row="2" Margin="0,0,0,20">
      <TextBlock Text="Include in Export"
                 FontWeight="SemiBold"
                 Margin="0,0,0,8"/>
      <CheckBox IsChecked="{Binding ExportProductionReady}"
                Margin="0,4">
        <StackPanel Orientation="Horizontal" Spacing="6">
          <Ellipse Width="10" Height="10" Fill="#4CAF50" VerticalAlignment="Center"/>
          <TextBlock Text="Production Ready" Foreground="#4CAF50"/>
          <TextBlock Text="{Binding ProductionReadyCount, StringFormat='({0})'}" Opacity="0.7"/>
        </StackPanel>
      </CheckBox>
      <CheckBox IsChecked="{Binding ExportUnrated}"
                Margin="0,4">
        <StackPanel Orientation="Horizontal" Spacing="6">
          <Ellipse Width="10" Height="10" Fill="#888" VerticalAlignment="Center"/>
          <TextBlock Text="Unrated"/>
          <TextBlock Text="{Binding UnratedCount, StringFormat='({0})'}" Opacity="0.7"/>
        </StackPanel>
      </CheckBox>
      <CheckBox IsChecked="{Binding ExportTrash}"
                Margin="0,4">
        <StackPanel Orientation="Horizontal" Spacing="6">
          <Ellipse Width="10" Height="10" Fill="#F44336" VerticalAlignment="Center"/>
          <TextBlock Text="Trash" Foreground="#F44336"/>
          <TextBlock Text="{Binding TrashCount, StringFormat='({0})'}" Opacity="0.7"/>
        </StackPanel>
      </CheckBox>
    </StackPanel>
    
    <!-- To Export Count (highlighted) -->
    <Border Grid.Row="3" 
            Background="#2D7D46" 
            CornerRadius="8" 
            Padding="16"
            Margin="0,0,0,20"
            IsVisible="{Binding CanExport}">
      <Grid ColumnDefinitions="*,Auto">
        <TextBlock Grid.Column="0" 
                   Text="Will be exported:" 
                   FontWeight="SemiBold"
                   VerticalAlignment="Center"/>
        <TextBlock Grid.Column="1" 
                   Text="{Binding ToExportText}" 
                   FontWeight="Bold"
                   FontSize="16"
                   HorizontalAlignment="Right"/>
      </Grid>
    </Border>
    
    <!-- Warning when no files to export -->
    <Border Grid.Row="3" 
            Background="#7D2D2D" 
            CornerRadius="8" 
            Padding="16"
            Margin="0,0,0,20"
            IsVisible="{Binding !CanExport}">
      <TextBlock Text="Select at least one category to export."
                 HorizontalAlignment="Center"
                 FontWeight="SemiBold"/>
    </Border>
    
    <!-- Buttons -->
    <StackPanel Grid.Row="4" 
                Orientation="Horizontal" 
                HorizontalAlignment="Right" 
                Spacing="8">
      <Button Content="Cancel" 
              Width="100"
              Click="OnCancelClick"/>
      <Button Content="Export" 
              Width="100"
              Background="#2D7D46"
              IsEnabled="{Binding CanExport}"
              Click="OnExportClick"/>
    </StackPanel>
    
  </Grid>
</Window>
