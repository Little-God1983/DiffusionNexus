<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:DiffusionNexus.UI.ViewModels"
        xmlns:local="using:DiffusionNexus.UI.Views"
        xmlns:classes="clr-namespace:DiffusionNexus.UI.Classes"
        xmlns:media="clr-namespace:Avalonia.Media.Imaging;assembly=Avalonia.Visuals"
        x:Class="DiffusionNexus.UI.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Name="MainWin"
        Width="1100" Height="700"
        Icon="avares://DiffusionNexus.UI/Assets/avalonia-logo.ico"
        Title="DiffusionNexus.UI">

  <Window.DataContext>
    <vm:MainWindowViewModel/>
  </Window.DataContext>

  <SplitView IsPaneOpen="{Binding IsMenuOpen}"
             DisplayMode="CompactOverlay"
             CompactPaneLength="60"
             OpenPaneLength="200"
             PanePlacement="Left">
    <!-- Sidebar Pane -->
    <SplitView.Pane>
      <StackPanel VerticalAlignment="Stretch" Spacing="10" Margin="0,10">
        <!-- Hamburger toggle -->
        <Button Content="☰" Command="{Binding ToggleMenuCommand}" HorizontalAlignment="Left"/>

        <!-- Module buttons -->
        <ItemsControl ItemsSource="{Binding Modules}">
          <ItemsControl.ItemTemplate>
            <DataTemplate x:DataType="classes:ModuleItem">
              <Button Command="{Binding DataContext.ChangeModuleCommand, ElementName=MainWin}"
                      CommandParameter="{Binding .}">
                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Image Source="{Binding Icon}" Width="24" Height="24"/>
                  <TextBlock Text="{Binding Name}"
                             IsVisible="{Binding DataContext.IsMenuOpen, ElementName=MainWin}"/>
                </StackPanel>
              </Button>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>

        <StackPanel VerticalAlignment="Bottom" Spacing="5" Margin="0,40,0,0">
          <Button Content="YouTube" Command="{Binding OpenYoutubeCommand}"/>
          <Button Content="Civitai" Command="{Binding OpenCivitaiCommand}"/>
          <Button Content="⚙ Settings" Command="{Binding OpenSettingsCommand}"/>
        </StackPanel>
      </StackPanel>
    </SplitView.Pane>

    <!-- Main content area -->
    <SplitView.Content>
      <ContentControl Content="{Binding CurrentModuleView}"/>
    </SplitView.Content>
  </SplitView>
</Window>