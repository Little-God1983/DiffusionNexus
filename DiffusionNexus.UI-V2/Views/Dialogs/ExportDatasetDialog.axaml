<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="using:DiffusionNexus.UI.Views.Dialogs"
        xmlns:vm="using:DiffusionNexus.UI.ViewModels"
        x:Class="DiffusionNexus.UI.Views.Dialogs.ExportDatasetDialog"
        x:DataType="vm:ExportDatasetDialogViewModel"
        Width="500"
        SizeToContent="Height"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        Background="#252526">
  
  <Grid Margin="24" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto">
    
    <!-- Title -->
    <TextBlock Grid.Row="0" 
               Text="{Binding DatasetName, StringFormat='Export: {0}'}"
               FontSize="18"
               FontWeight="SemiBold"
               Foreground="#D4A574"
               Margin="0,0,0,20"/>
    
    <!-- Export Type Selection -->
    <StackPanel Grid.Row="1" Margin="0,0,0,16">
      <TextBlock Text="Export Format"
                 FontWeight="SemiBold"
                 Margin="0,0,0,8"/>
      <StackPanel Orientation="Horizontal" Spacing="16">
        <RadioButton Content="Single Files (Images/Videos + .txt)"
                     IsChecked="{Binding IsSingleFilesExport}"
                     GroupName="ExportType"/>
        <RadioButton Content="ZIP Archive"
                     IsChecked="{Binding IsZipExport}"
                     GroupName="ExportType"/>
      </StackPanel>
    </StackPanel>
    
    <!-- Export Options -->
    <StackPanel Grid.Row="2" Margin="0,0,0,20">
      <TextBlock Text="Export Options"
                 FontWeight="SemiBold"
                 Margin="0,0,0,8"/>
      <CheckBox Content="Export unrated images/videos"
                IsChecked="{Binding ExportUnrated}"
                Margin="0,4"/>
      <CheckBox Content="Export failed images/videos as well"
                IsChecked="{Binding IncludeFailedImages}"
                Margin="0,4"/>
    </StackPanel>
    
    <!-- Preview Counts -->
    <Border Grid.Row="3" 
            Background="#1A1A1A" 
            CornerRadius="8" 
            Padding="16"
            Margin="0,0,0,20">
      <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto" ColumnDefinitions="*,Auto">
        
        <TextBlock Grid.Row="0" Grid.ColumnSpan="2"
                   Text="Preview"
                   FontWeight="SemiBold"
                   Foreground="#D4A574"
                   Margin="0,0,0,12"/>
        
        <!-- Total -->
        <TextBlock Grid.Row="1" Grid.Column="0" Text="In folder:" Opacity="0.7"/>
        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding TotalText}" HorizontalAlignment="Right"/>
        
        <!-- Production Ready -->
        <StackPanel Grid.Row="2" Grid.Column="0" Orientation="Horizontal">
          <Ellipse Width="10" Height="10" Fill="#4CAF50" Margin="0,0,6,0" VerticalAlignment="Center"/>
          <TextBlock Text="Production Ready:" Foreground="#4CAF50"/>
        </StackPanel>
        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ProductionReadyText}" Foreground="#4CAF50" HorizontalAlignment="Right"/>
        
        <!-- Failed -->
        <StackPanel Grid.Row="3" Grid.Column="0" Orientation="Horizontal">
          <Ellipse Width="10" Height="10" Fill="#F44336" Margin="0,0,6,0" VerticalAlignment="Center"/>
          <TextBlock Text="Failed:" Foreground="#F44336"/>
        </StackPanel>
        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding FailedText}" Foreground="#F44336" HorizontalAlignment="Right"/>
        
        <!-- Unrated -->
        <StackPanel Grid.Row="4" Grid.Column="0" Orientation="Horizontal">
          <Ellipse Width="10" Height="10" Fill="#888" Margin="0,0,6,0" VerticalAlignment="Center"/>
          <TextBlock Text="Unrated:" Opacity="0.7"/>
        </StackPanel>
        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding UnratedText}" Opacity="0.7" HorizontalAlignment="Right"/>
        
        <!-- Separator -->
        <Border Grid.Row="5" Grid.ColumnSpan="2" 
                Height="1" 
                Background="#444" 
                Margin="0,12,0,12"/>
        
      </Grid>
    </Border>
    
    <!-- To Export Count (highlighted) -->
    <Border Grid.Row="4" 
            Background="#2D7D46" 
            CornerRadius="8" 
            Padding="16"
            Margin="0,0,0,20"
            IsVisible="{Binding CanExport}">
      <Grid ColumnDefinitions="*,Auto">
        <TextBlock Grid.Column="0" 
                   Text="Will be exported:" 
                   FontWeight="SemiBold"
                   VerticalAlignment="Center"/>
        <TextBlock Grid.Column="1" 
                   Text="{Binding ToExportText}" 
                   FontWeight="Bold"
                   FontSize="16"
                   HorizontalAlignment="Right"/>
      </Grid>
    </Border>
    
    <!-- Warning when no files to export -->
    <Border Grid.Row="4" 
            Background="#7D2D2D" 
            CornerRadius="8" 
            Padding="16"
            Margin="0,0,0,20"
            IsVisible="{Binding !CanExport}">
      <TextBlock Text="No files match the current filter settings."
                 HorizontalAlignment="Center"
                 FontWeight="SemiBold"/>
    </Border>
    
    <!-- Buttons -->
    <StackPanel Grid.Row="5" 
                Orientation="Horizontal" 
                HorizontalAlignment="Right" 
                Spacing="8">
      <Button Content="Cancel" 
              Width="100"
              Click="OnCancelClick"/>
      <Button Content="Export" 
              Width="100"
              Background="#2D7D46"
              IsEnabled="{Binding CanExport}"
              Click="OnExportClick"/>
    </StackPanel>
    
  </Grid>
</Window>
